
#============= hal_bluetooth_default ==============
#allow hal_bluetooth_default self:udp_socket create;
allow hal_bluetooth_default serial_device:chr_file { read write open };
allow hal_bluetooth_default sysfs:file rw_file_perms;
allow hal_bluetooth_default media_rw_data_file:dir { write search create add_name };
allow hal_bluetooth_default media_rw_data_file:file { write create open };
allow hal_bluetooth_default storage_stub_file:dir getattr;
allow hal_bluetooth_default tmpfs:dir { write };
allow hal_bluetooth_default bluetooth_data_file:dir search;
allow hal_bluetooth_default bluetooth_data_file:file open;
allow hal_bluetooth_default bluetooth_data_file:file read;
allow hal_bluetooth_default bluetooth_logs_data_file:dir { write search create add_name remove_name};
allow hal_bluetooth_default bluetooth_logs_data_file:file {open read write create rename unlink getattr};
allow hal_bluetooth_default proc:file open;
allow hal_bluetooth_default proc:file write;

# Socket creation under /data/misc/bluedroid.
type_transition hal_bluetooth_default bluetooth_data_file:sock_file bluetooth_socket;

# Allow access to net_admin ioctls
allowxperm hal_bluetooth_default self:udp_socket ioctl priv_sock_ioctls;

allow hal_bluetooth_default bluetooth_data_file:dir create_dir_perms;
allow hal_bluetooth_default bluetooth_data_file:file create_file_perms;
allow hal_bluetooth_default rtk_bt_device:chr_file rw_file_perms;

# Socket creation under /data/misc/bluedroid.
#allow hal_bluetooth_default bluetooth_socket:sock_file create_file_perms;
allow hal_bluetooth_default self:capability net_admin;
